<?php


#-------------------------------------------------------------------------------
/** @author Великодный В.В. (Joonte Ltd.) */
/******************************************************************************/
/******************************************************************************/
$__args_list = Array('MenuPath','Child');
/******************************************************************************/
Eval(COMP_INIT);
/******************************************************************************/
/******************************************************************************/
$XML = Styles_Menu($MenuPath);
if(Is_Error($XML))
  return ERROR | @Trigger_Error(500);
#-------------------------------------------------------------------------------
$Items = $XML['Items'];
#-------------------------------------------------------------------------------
$Parse = <<<EOD
<TABLE cellspacing="0" cellpadding="0" width="100%">
 <TR>
  <TD>
   <TABLE cellspacing="0" cellpadding="0" width="100%">
    <TR>
     <TD>
      <TABLE id="TabMenu" cellspacing="0" cellpadding="0" />
     </TD>
    </TR>
    <TR height="2">
     <TD style="background-image:url(SRC:{Images/TabLine.png});" />
    </TR>
   </TABLE>
  </TD>
 </TR>
 <TR>
  <TD id="TabInto" />
 </TR>
</TABLE>
EOD;
#-------------------------------------------------------------------------------
$DOM = new DOM($Parse);
#-------------------------------------------------------------------------------
$DOM->AddChild('TabInto',$Child);
#-------------------------------------------------------------------------------
$Tr = new Tag('TR',new Tag('TD',Array('width'=>'10px')));
#-------------------------------------------------------------------------------
foreach($Items as $Item){
  #-----------------------------------------------------------------------------
  $Td = new Tag('TD');
  #-----------------------------------------------------------------------------
  $Prefix = ($Item['IsActive']?'Active':'UnActive');
#-------------------------------------------------------------------------------
$Parse = <<<EOD
<TABLE cellspacing="0" cellpadding="0">
 <TR>
  <TD width="10">
   <IMG id="TabLeft" style="display:block;" width="10" height="25" src="SRC:{Images/TabLeft%s.gif}" />
  </TD>
  <TD id="TabCenter" style="white-space:nowrap;background-image:url(SRC:{Images/TabCenter%s.png});">%s</TD>
  <TD width="10">
   <IMG id="TabRight" style="display:block;" width="10" height="25" src="SRC:{Images/TabRight%s.gif}" />
  </TD>
 </TR>
</TABLE>
EOD;
#-------------------------------------------------------------------------------
  $A = new Tag('A',Array('href'=>$Item['Href']),$Item['Text']);
  #-----------------------------------------------------------------------------
  if(IsSet($Item['Prompt'])){
    #---------------------------------------------------------------------------
    $LinkID = UniqID('ID');
    #---------------------------------------------------------------------------
    $Links = &Links();
    #---------------------------------------------------------------------------
    $Links[$LinkID] = &$A;
    #---------------------------------------------------------------------------
    $Comp = Comp_Load('Form/Prompt',$LinkID,$Item['Prompt']);
    if(Is_Error($Comp))
      return ERROR | @Trigger_Error(500);
    #---------------------------------------------------------------------------
    UnSet($Links[$LinkID]);
  }
  #-----------------------------------------------------------------------------
  $Td->AddHTML(SPrintF($Parse,$Prefix,$Prefix,$A->ToXMLString(),$Prefix,$Prefix));
  #-----------------------------------------------------------------------------
  $Tr->AddChild($Td);
}
#-------------------------------------------------------------------------------
$Tr->AddChild(new Tag('TD',Array('width'=>'10px')));
#-------------------------------------------------------------------------------
$DOM->AddChild('TabMenu',$Tr);
#-------------------------------------------------------------------------------
return $DOM->Object;
#-------------------------------------------------------------------------------


?>
