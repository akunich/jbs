<?php

#-------------------------------------------------------------------------------
/** @author Великодный В.В. (Joonte Ltd.) */
/******************************************************************************/
/******************************************************************************/
$__args_list = Array('MenuPath','Child');
/******************************************************************************/
Eval(COMP_INIT);
/******************************************************************************/
/******************************************************************************/
$XML = Styles_Menu($MenuPath);
if(Is_Error($XML))
  return ERROR | @Trigger_Error(500);
#-------------------------------------------------------------------------------
$Items = $XML['Items'];
#-------------------------------------------------------------------------------
$DOM = new DOM(TemplateReplace('Tab.Table1'));
#-------------------------------------------------------------------------------
$DOM->AddChild('TabInto',$Child);
#-------------------------------------------------------------------------------
$Tr = new Tag('TR',new Tag('TD',Array('width'=>'10px')));
#-------------------------------------------------------------------------------
foreach($Items as $Item){
  #-----------------------------------------------------------------------------
  $Td = new Tag('TD');
  #-----------------------------------------------------------------------------
  $Prefix = ($Item['IsActive']?'Active':'UnActive');
  #-------------------------------------------------------------------------------
  $A = new Tag('A',Array('href'=>$Item['Href']),$Item['Text']);
  #-----------------------------------------------------------------------------
  if(IsSet($Item['Prompt'])){
    #---------------------------------------------------------------------------
    $LinkID = UniqID('ID');
    #---------------------------------------------------------------------------
    $Links = &Links();
    #---------------------------------------------------------------------------
    $Links[$LinkID] = &$A;
    #---------------------------------------------------------------------------
    $Comp = Comp_Load('Form/Prompt',$LinkID,$Item['Prompt']);
    if(Is_Error($Comp))
      return ERROR | @Trigger_Error(500);
    #---------------------------------------------------------------------------
    UnSet($Links[$LinkID]);
  }
  #-----------------------------------------------------------------------------
  $Td->AddHTML(TemplateReplace('Tab.Table2',Array('Prefix'=>$Prefix,'Href'=>($A->ToXMLString()))));
  #-----------------------------------------------------------------------------
  $Tr->AddChild($Td);
}
#-------------------------------------------------------------------------------
$Tr->AddChild(new Tag('TD',Array('width'=>'10px')));
#-------------------------------------------------------------------------------
$DOM->AddChild('TabMenu',$Tr);
#-------------------------------------------------------------------------------
return $DOM->Object;
#-------------------------------------------------------------------------------


?>
