<?php


#-------------------------------------------------------------------------------
/** @author Великодный В.В. (Joonte Ltd.) */
/******************************************************************************/
/******************************************************************************/
Eval(COMP_INIT);
/******************************************************************************/
/******************************************************************************/
$Args = Args();
#-------------------------------------------------------------------------------
$ClauseID = (integer) @$Args['ClauseID'];
#-------------------------------------------------------------------------------
Header('Content-Type: text/javascript');
#-------------------------------------------------------------------------------
echo "var tinyMCEImageList = [];\n";
#-------------------------------------------------------------------------------
$ClauseImages = DB_Select('ClausesFiles',Array('ID','FileName','Comment'),Array('Where'=>SPrintF("`ClauseID` = %u AND `FileName` REGEXP '^.+\.(png|jpg|gif|tiff)'",$ClauseID)));
#-------------------------------------------------------------------------------
switch(ValueOf($ClauseImages)){
  case 'error':
    return ERROR | @Trigger_Error(500);
  case 'exception':
    # No more...
  break;
  case 'array':
    #---------------------------------------------------------------------------
    foreach($ClauseImages as $ClausImage)
      echo SPrintF("tinyMCEImageList.push(['%s - %s','/ClauseImage?ImageID=%u&Scale=100']);\n",$ClausImage['Comment'],$ClausImage['FileName'],$ClausImage['ID']);
    #---------------------------------------------------------------------------
    return;
  default:
    return ERROR | @Trigger_Error(101);
}
#-------------------------------------------------------------------------------

?>
