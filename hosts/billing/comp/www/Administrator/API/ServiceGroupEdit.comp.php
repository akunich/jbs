<?php


#-------------------------------------------------------------------------------
/** @author Великодный В.В. (Joonte Ltd.) */
/******************************************************************************/
/******************************************************************************/
Eval(COMP_INIT);
/******************************************************************************/
/******************************************************************************/
if(Is_Error(System_Load('modules/Authorisation.mod')))
  return ERROR | @Trigger_Error(500);
#-------------------------------------------------------------------------------
$Args = Args();
#-------------------------------------------------------------------------------
$ServiceGroupID =  (integer) @$Args['ServiceGroupID'];
$Name           =   (string) @$Args['Name'];
$IsActive       =  (boolean) @$Args['IsActive'];
$SortID         =  (integer) @$Args['SortID'];
#-------------------------------------------------------------------------------
$IServiceGroup = Array(
  #-----------------------------------------------------------------------------
  'Name'     => $Name,
  'IsActive' => $IsActive,
  'SortID'   => $SortID
);
#-------------------------------------------------------------------------------
if($ServiceGroupID){
  #-----------------------------------------------------------------------------
  $IsUpdate = DB_Update('ServicesGroups',$IServiceGroup,Array('ID'=>$ServiceGroupID));
  if(Is_Error($IsUpdate))
    return ERROR | @Trigger_Error(500);
  #-----------------------------------------------------------------------------
  $IsUpdate = DB_Update('Services',Array('IsActive'=>$IsActive),Array('Where'=>SPrintF('`ServicesGroupID` = %u',$ServiceGroupID)));
  if(Is_Error($IsUpdate))
    return ERROR | @Trigger_Error(500);
  #-----------------------------------------------------------------------------
}else{
  #-----------------------------------------------------------------------------
  $IsInsert = DB_Insert('ServicesGroups',$IServiceGroup);
  if(Is_Error($IsInsert))
    return ERROR | @Trigger_Error(500);
}
#-------------------------------------------------------------------------------
$IsFlush = CacheManager::flush();
if(!$IsFlush)
  @Trigger_Error(500);
#-------------------------------------------------------------------------------
return Array('Status'=>'Ok');
#-------------------------------------------------------------------------------

?>
