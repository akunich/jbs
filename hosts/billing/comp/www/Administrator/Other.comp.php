<?php

#-------------------------------------------------------------------------------
/** @author Alex Keda, for www.host-food.ru */
/******************************************************************************/
/******************************************************************************/
Eval(COMP_INIT);
/******************************************************************************/
/******************************************************************************/
if(Is_Error(System_Load('classes/DOM.class.php','modules/Authorisation.mod')))
	return ERROR | @Trigger_Error(500);
#-------------------------------------------------------------------------------
$DOM = new DOM();
#-------------------------------------------------------------------------------
$Links = &Links();
#-------------------------------------------------------------------------------
$Links['DOM'] = &$DOM;
#-------------------------------------------------------------------------------
if(Is_Error($DOM->Load('Base')))
	return ERROR | @Trigger_Error(500);
#-------------------------------------------------------------------------------
$DOM->AddAttribs('MenuLeft',Array('args'=>'Administrator/AddIns'));
#-------------------------------------------------------------------------------
$DOM->AddText('Title','Дополнения → Мастера настройки → Прочее');
#-------------------------------------------------------------------------------
$NoBody = new Tag('NOBODY');
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
$NoBody->AddChild(new Tag('BR'));
$List = new Tag('UL',Array('class'=>'Standard'));
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
$Menus = Styles_XML('Menus/Administrator/Masters.Other.xml');
#Debug(SPrintF("[comp/www/Administrator/SystemMaintenance]: Menus = %s",print_r($Menus,true)));
#-------------------------------------------------------------------------------
foreach($Menus['Items'] as $Menu){
	#-------------------------------------------------------------------------------
	$A = new Tag('A',Array('class'=>'Standard','href'=>$Menu['Href']),$Menu['Text']);
	#-------------------------------------------------------------------------------
	if(IsSet($Menu['Prompt'])){
		#-------------------------------------------------------------------------------
		$LinkID = UniqID('Href');
		#-------------------------------------------------------------------------------
		$Links[$LinkID] = &$A;
		#-------------------------------------------------------------------------------
		$Comp = Comp_Load('Form/Prompt',$LinkID,$Menu['Prompt']);
		#-------------------------------------------------------------------------------
		if(Is_Error($Comp))
			return ERROR | @Trigger_Error(500);
		#-------------------------------------------------------------------------------
		UnSet($Links[$LinkID]);
		#-------------------------------------------------------------------------------
	}
	#-------------------------------------------------------------------------------
	$List->AddChild(new Tag('LI',$A));
	#-------------------------------------------------------------------------------
}
#---------------------------------------------------------------------------
#---------------------------------------------------------------------------
$NoBody->AddChild($List);
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
$Into = Comp_Load('Tab','Administrator/Masters',$NoBody);
if(Is_Error($Into))
	return ERROR | @Trigger_Error(500);
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
$DOM->AddChild('Into',$Into);
#$DOM->AddChild('Into',$NoBody);
#-------------------------------------------------------------------------------
$Out = $DOM->Build();
#-------------------------------------------------------------------------------
if(Is_Error($Out))
	return ERROR | @Trigger_Error(500);
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
return $Out;
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
?>
