<?php

#-------------------------------------------------------------------------------
/** @author Alex Keda, for www.host-food.ru */
/******************************************************************************/
/******************************************************************************/
Eval(COMP_INIT);
/******************************************************************************/
/******************************************************************************/
$Args = Args();
#-------------------------------------------------------------------------------
$UserID = (integer) @$Args['UserID'];
#-------------------------------------------------------------------------------
if(Is_Error(System_Load('libs/Image.php','libs/Upload.php')))
	return ERROR | @Trigger_Error(500);
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
$UserID = ($UserID?$UserID:@$GLOBALS['__USER']['ID']);
#-------------------------------------------------------------------------------
if(!$UserID)
	return 'No user defined';
#-------------------------------------------------------------------------------
# проверяем наличие файла
if(!GetUploadedFileSize('Users',$UserID)){
	#-------------------------------------------------------------------------------
	$Path = Styles_Element('Images/UserFoto.jpg');
	if(Is_Error($Path))
		return ERROR | @Trigger_Error(500);
	#-------------------------------------------------------------------------------
	$Foto = IO_Read($Path);
	if(Is_Error($Foto))
		return ERROR | @Trigger_Error(500);
	#-------------------------------------------------------------------------------
}else{
	#-------------------------------------------------------------------------------
	$File = GetUploadedFile('Users',$UserID);
	#-------------------------------------------------------------------------------
	$Foto = $File['Data'];
	#-------------------------------------------------------------------------------
}
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
Header('Content-Type: image/jpg');
#-------------------------------------------------------------------------------
return $Foto;
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------

?>
