<?php

#-------------------------------------------------------------------------------
/** @author Alex Keda, for www.host-food.ru */
/******************************************************************************/
/******************************************************************************/
$__args_list = Array('PaymentSystemID','InvoiceID','Summ');
/******************************************************************************/
Eval(COMP_INIT);
/******************************************************************************/
/******************************************************************************/
$Config = Config();
#-------------------------------------------------------------------------------
$Settings = $Config['Invoices']['PaymentSystems']['Yandex'];
#-------------------------------------------------------------------------------
$Send = $Settings['Send'];
#-------------------------------------------------------------------------------
$Send['Sum'] = Round($Summ/$Settings['Course'],2);
#-------------------------------------------------------------------------------
$Send['customerNumber'] = $GLOBALS['__USER']['ID'];
#-------------------------------------------------------------------------------
$Send['orderNumber'] = $InvoiceID;
#-------------------------------------------------------------------------------
$Comp = Comp_Load('Formats/Invoice/Number',$InvoiceID);
if(Is_Error($Comp))
	return ERROR | @Trigger_Error(500);
#-------------------------------------------------------------------------------
$Md5 = Array(
  $Send['Sum'],
  $Send['CurrencyID'],
  $Send['BankID'],
  $Send['ShopID'],
  $Send['orderNumber'],
  $Send['customerNumber'],
  $Settings['Hash']
);
#-------------------------------------------------------------------------------
$Send['md5'] = Md5(Implode(';',$Md5));
#-------------------------------------------------------------------------------
return $Send;
#-------------------------------------------------------------------------------

?>
