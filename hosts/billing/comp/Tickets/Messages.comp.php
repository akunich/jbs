<?php


#-------------------------------------------------------------------------------
/** @author Великодный В.В. (Joonte Ltd.) */
/******************************************************************************/
/******************************************************************************/
$__args_list = Array('TicketID');
/******************************************************************************/
Eval(COMP_INIT);
/******************************************************************************/
/******************************************************************************/
$IsQuery = DB_Query(SPrintF('SELECT EDESKS_MESSAGES(%u,%u) as `Count`',$TicketID,$GLOBALS['__USER']['ID']));
if(Is_Error($IsQuery))
  return ERROR | @Trigger_Error(500);
#-------------------------------------------------------------------------------
$Rows = MySQL::Result($IsQuery);
if(Is_Error($Rows))
  return ERROR | @Trigger_Error(500);
#-------------------------------------------------------------------------------
$Row = Current($Rows);
#-------------------------------------------------------------------------------
$Total = DB_Count('EdesksMessages',Array('Where'=>SPrintF('`EdeskID` = %u',$TicketID)));
if(Is_Error($Total))
  return ERROR | @Trigger_Error(500);
#-------------------------------------------------------------------------------
return SPrintF('%u из %u',$Row['Count'],$Total);
#-------------------------------------------------------------------------------

?>
