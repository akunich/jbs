<?php


#-------------------------------------------------------------------------------
/** @author Великодный В.В. (Joonte Ltd.) */
/******************************************************************************/
/******************************************************************************/
Eval(COMP_INIT);
/******************************************************************************/
/******************************************************************************/
$Tmp = System_Element('tmp');
if(Is_Error($Tmp))
  return ERROR | @Trigger_Error(500);
#-------------------------------------------------------------------------------
$Folder = SPrintF('%s/files',$Tmp);
#-------------------------------------------------------------------------------
if(File_Exists($Folder)){
  #-----------------------------------------------------------------------------
  $Files = IO_Scan($Folder);
  if(Is_Error($Files))
    return ERROR | @Trigger_Error(500);
  #-----------------------------------------------------------------------------
  foreach($Files as $File){
    #---------------------------------------------------------------------------
    $Path = SPrintF('%s/%s',$Folder,$File);
    #---------------------------------------------------------------------------
    if(Time() - FileMTime($Path) > 86400){
      #-------------------------------------------------------------------------
      if(!@UnLink($Path))
        return ERROR | @Trigger_Error(SPrintF('[comp/Tasks/Temp]: не удалось удалить файл (%s)',$Path));
    }
  }
}
#-------------------------------------------------------------------------------
return 86400;
#-------------------------------------------------------------------------------

?>
