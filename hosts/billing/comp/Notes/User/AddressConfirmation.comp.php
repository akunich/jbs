<?php

#-------------------------------------------------------------------------------
/** @author Alex Keda, for www.host-food.ru */
/******************************************************************************/
/******************************************************************************/
Eval(COMP_INIT);
/******************************************************************************/
/******************************************************************************/
$Result = Array();
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
if(!CacheManager::isEnabled())
	return $Result;
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
$Config = Config();
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
# перебираем контакты юзера, выводим их
foreach($GLOBALS['__USER']['Contacts'] as $Contact){
	#-------------------------------------------------------------------------------
	foreach(Array_Keys($Config['Notifies']['Methods']) as $MethodID){
		#-------------------------------------------------------------------------------
		if(!$Config['Notifies']['Methods'][$MethodID]['IsActive'])
			continue;
		#-------------------------------------------------------------------------------
		if($Contact['MethodID'] == $MethodID && !$Contact['Confirmed'] && $Config['Interface']['User']['Notes'][$MethodID]['ConfirmRequire']){
			#-------------------------------------------------------------------------------
			$NoBody = new Tag('NOBODY');
			$NoBody->AddHTML(TemplateReplace('Notes.User.Confirmation', Array('Address'=>$Contact['Address'],'Method'=>$Config['Notifies']['Methods'][$MethodID])));
			$NoBody->AddChild(new Tag('STRONG', new Tag('A', Array('href' => SPrintF("javascript:ShowWindow('/ContactEdit?ContactID=%u');",$Contact['ID'])), '[Мои настройки]')));
			#-------------------------------------------------------------------------------
			$Result[] = $NoBody;
			#-------------------------------------------------------------------------------
		}
		#-------------------------------------------------------------------------------
	}
	#-------------------------------------------------------------------------------
}
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
return $Result;
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
?>
