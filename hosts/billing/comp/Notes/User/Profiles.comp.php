<?php

#-------------------------------------------------------------------------------
/** @author Великодный В.В. (Joonte Ltd.) */
/******************************************************************************/
/******************************************************************************/
Eval(COMP_INIT);
/******************************************************************************/
/******************************************************************************/
$Result = Array();
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
$Config = Config();
#-------------------------------------------------------------------------------
$Settings = $Config['Interface']['User']['Notes']['Profiles'];
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
if(!$Settings['ProfileOnFilling'])
	return $Result;
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
$Profiles = DB_Select('Profiles',Array('ID','Name'),Array('Where'=>SPrintF("`UserID` = @local.__USER_ID AND `StatusID` = 'OnFilling'")));
#-------------------------------------------------------------------------------
switch(ValueOf($Profiles)){
case 'error':
	return ERROR | @Trigger_Error(500);
case 'exception':
	# No more...
	break;
case 'array':
	#-------------------------------------------------------------------------------
	$Result = Array();
	#-------------------------------------------------------------------------------
	foreach($Profiles as $Profile){
		#-------------------------------------------------------------------------------
		$NoBody = new Tag('NOBODY');
		#-------------------------------------------------------------------------------
		$NoBody->AddHTML(TemplateReplace('Notes.User.Profiles',$Profile));
		#-------------------------------------------------------------------------------
		$Result[] = $NoBody;
		#-------------------------------------------------------------------------------
	}
	#-------------------------------------------------------------------------------
	break;
	#-------------------------------------------------------------------------------
default:
	return ERROR | @Trigger_Error(101);
}
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
return $Result;
#-------------------------------------------------------------------------------


?>
