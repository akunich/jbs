<?php


#-------------------------------------------------------------------------------
/** @author Великодный В.В. (Joonte Ltd.) */
/******************************************************************************/
/******************************************************************************/
Eval(COMP_INIT);
/******************************************************************************/
/******************************************************************************/
$CacheID = Md5($__FILE__);
#-------------------------------------------------------------------------------
$Result = CacheManager::get($CacheID);
if(!Is_Error($Result))
  return $Result;
#-------------------------------------------------------------------------------
$Result = Array();
#-------------------------------------------------------------------------------
$Count = DB_Count('Events',Array('Where'=>"`IsReaded` != 'yes'"));
if(Is_Error($Count))
  return ERROR | @Trigger_Error(500);
#-------------------------------------------------------------------------------
if($Count){
  #-----------------------------------------------------------------------------
  $Result = Array();
  #-----------------------------------------------------------------------------
  $NoBody = new Tag('NOBODY');
#-------------------------------------------------------------------------------
$Parse = <<<EOD
<NOBODY>
 <SPAN>Внимание! Некоторые события</SPAN>
 <SPAN style="font-size:14px;font-weight:bold;">%s</SPAN>
 <SPAN> требуют Вашего внимания.</SPAN>
 <SPAN>Для этого: перейдите в раздел события </SPAN>
 <A style="font-size:14px;" href="/Administrator/Events?PatternOutID=NeedReaded">[необходимые для прочтения]</A>
 <SPAN> и ознакомьтесь с содержанием событий. После этого Вы сможете отметить события как прочитанные.</SPAN>
</NOBODY>
EOD;
#-------------------------------------------------------------------------------
  $NoBody->AddHTML(SPrintF($Parse,$Count));
  #-----------------------------------------------------------------------------
  $Result = Array($NoBody);
}
#-------------------------------------------------------------------------------
CacheManager::add($CacheID,$Result,60);
#-------------------------------------------------------------------------------
return $Result;
#-------------------------------------------------------------------------------


?>
