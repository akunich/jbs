<?php

#-------------------------------------------------------------------------------
/** @author Alex Keda, for www.host-food.ru */
/******************************************************************************/
/******************************************************************************/
Eval(COMP_INIT);
/******************************************************************************/
/******************************************************************************/
$Result = Array();
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
$CacheID = Md5($__FILE__);
$Out = CacheManager::get($CacheID);
#-------------------------------------------------------------------------------
if($Out)
	return $Result;
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
$Config = Config();
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
$Where = Array(
		SPrintF("`TABLE_SCHEMA` = '%s'",$Config['DBConnection']['DbName']),
		"`TABLE_NAME` IN ('Users','Services','Orders','OrdersConsider','Bonuses','Clauses','Contracts','ContractsEnclosures','DomainsOrders','DomainsSchemes','Edesks','EdesksMessages','HostingOrders','HostingSchemes','HostingServers','HostingServersGroups','Invoices','InvoicesItems','OrdersConsider','OrdersFields','OrdersTransfer','Permissions','Politics','Postings','Profiles','PromoCodes','PromoCodesExtinguished','Registrators','ServicesFields','ServicesGroups','Tasks','WorksComplite')"
	);
#-------------------------------------------------------------------------------
$Tables = DB_Select('`INFORMATION_SCHEMA`.`TABLES`',Array('TABLE_NAME','ENGINE'),Array('Where'=>$Where));
switch(ValueOf($Tables)){
case 'array':
	#-------------------------------------------------------------------------------
	foreach($Tables as $Table){
		#-------------------------------------------------------------------------------
		if($Table['ENGINE'] != 'InnoDB'){
			#-------------------------------------------------------------------------------
			Debug(SPrintF('[comp/Notes/Administrator/CheckTablesEngines]: Incorrect Table Engine, table = %s',$Table['TABLE_NAME']));
			return new gException('TABLE_ENGINE_NOT_InnoDB','Движок таблицы не InnoDB');
			#-------------------------------------------------------------------------------
		}
		#-------------------------------------------------------------------------------
	}
	#-------------------------------------------------------------------------------
}
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
CacheManager::add($CacheID,'OK',100500);
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
return $Result;
#-------------------------------------------------------------------------------


?>
