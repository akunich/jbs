<?php
#-------------------------------------------------------------------------------
/** @author Великодный В.В. (Joonte Ltd.) */
#-------------------------------------------------------------------------------
if(!Define('BUTE',01))
  return ERROR | @Trigger_Error('[system/libs/Bytes.lib]: ошибка определения константы (BUTE)');
#-------------------------------------------------------------------------------
if(!Define('WORD',02))
  return ERROR | @Trigger_Error('[system/libs/Bytes.lib]: ошибка определения константы (WORD)');
#-------------------------------------------------------------------------------
if(!Define('DWORD',04))
  return ERROR | @Trigger_Error('[system/libs/Bytes.lib]: ошибка определения константы (DWORD)');
#-------------------------------------------------------------------------------
function Bytes_Encode($Bytes){
  /****************************************************************************/
  $__args_types = Array('string');
  #-----------------------------------------------------------------------------
  $__args__ = Func_Get_Args(); Eval(FUNCTION_INIT);
  /****************************************************************************/
  $Result = '';
  #-----------------------------------------------------------------------------
  foreach(Explode(' ',$Bytes) as $Byte)
    $Result .= Chr(HexDec($Byte));
  #-----------------------------------------------------------------------------
  return $Result;
}
#-------------------------------------------------------------------------------
function Bytes_Decode($String,$Separator = ''){
  /****************************************************************************/
  $__args_types = Array('string');
  #-----------------------------------------------------------------------------
  $__args__ = Func_Get_Args(); Eval(FUNCTION_INIT);
  /****************************************************************************/
  $Result = '';
  #-----------------------------------------------------------------------------
  for($i=0;$i<StrLen($String);$i++)
    $Result .= SPrintF('%02x',Ord($String[$i])).$Separator;
  #-----------------------------------------------------------------------------
  return $Result;
}
#-------------------------------------------------------------------------------
# Функция записывает значение разбивая по байтам. Bits - кол-во бит
#-------------------------------------------------------------------------------
function Bytes_I2B($Bits,$Value = 0){
  /****************************************************************************/
  $__args_types = Array('integer');
  #-----------------------------------------------------------------------------
  $__args__ = Func_Get_Args(); Eval(FUNCTION_INIT);
  /****************************************************************************/
  $Result = '';
  #-----------------------------------------------------------------------------
  for ($i=0; $i<$Bits; $i++)
    $Result = Chr(($Value >> ($i*8) & 0xFF)).$Result;
  #-----------------------------------------------------------------------------
  return $Result;
}
#-------------------------------------------------------------------------------
function Bytes_Trim($String){
  /****************************************************************************/
  $__args_types = Array('string');
  #-----------------------------------------------------------------------------
  $__args__ = Func_Get_Args(); Eval(FUNCTION_INIT);
  /****************************************************************************/
  return DecHex(HexDec($String));
}
#-------------------------------------------------------------------------------
function Bytes_Get($String,$Start,$Length = BUTE){
  /****************************************************************************/
  $__args_types = Array('string','integer','integer');
  #-----------------------------------------------------------------------------
  $__args__ = Func_Get_Args(); Eval(FUNCTION_INIT);
  /****************************************************************************/
  $Section = SubStr($String,$Start,$Length);
  if(Is_String($Section))
    return Bytes_Trim(Bytes_Decode($Section));
  #-----------------------------------------------------------------------------
  return FALSE;
}
#-------------------------------------------------------------------------------
?>