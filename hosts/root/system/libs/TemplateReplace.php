<?php

#-------------------------------------------------------------------------------
/** @author Alex Keda, for www.host-food.ru */
/******************************************************************************/
/******************************************************************************/
Eval(COMP_INIT);
/******************************************************************************/
/******************************************************************************/
#if(Is_Error(System_Load('classes/Server.class.php')))
#	return ERROR | @Trigger_Error(500);
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
function TemplateReplace($Text,$Params,$NoBody = TRUE){
	#-------------------------------------------------------------------------------
	$Text = Trim($Text);
	#-------------------------------------------------------------------------------
	# проверяем что нам сунули - текст или файл
	if(!Preg_Match('/\s/',$Text)){
		#-------------------------------------------------------------------------------
		# достаём текст из файла
		$Path = System_Element(SPrintF('templates/modules/%s.html',$Text));
		#-------------------------------------------------------------------------------
		if(Is_Error($Path)){
			#-------------------------------------------------------------------------------
			$Text = SprintF('Отсутствует шаблон сообщения (templates/modules/%s.html)',$Text);
			#-------------------------------------------------------------------------------
		}else{
			#-------------------------------------------------------------------------------
			$Text = Trim(IO_Read($Path));
			#-------------------------------------------------------------------------------
		}
		#-------------------------------------------------------------------------------
	}
	#-------------------------------------------------------------------------------
	#-------------------------------------------------------------------------------
	if($NoBody)
		$Text = SPrintF('<NOBODY>%s</NOBODY>',$Text);
	#-------------------------------------------------------------------------------
	#-------------------------------------------------------------------------------
	$Replace = Array_ToLine($Params,'%');
	#-------------------------------------------------------------------------------
	foreach(Array_Keys($Replace) as $Key)
		$Text = Str_Replace($Key,$Replace[$Key],$Text);
	#-------------------------------------------------------------------------------
	#-------------------------------------------------------------------------------
	return $Text;
	#-------------------------------------------------------------------------------
}
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------

?>
