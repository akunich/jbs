//------------------------------------------------------------------------------
/** @author Бреславский А.В. (Joonte Ltd.) */
//------------------------------------------------------------------------------
// <body onselectstart="return false">
//------------------------------------------------------------------------------
function WidgetInit(event,$WidgetID){
  //----------------------------------------------------------------------------
  document.onmousedown = function(){ return false };
  //----------------------------------------------------------------------------
  var $Widget = document.getElementById($WidgetID);
  //----------------------------------------------------------------------------
  with($Widget.style){
    //--------------------------------------------------------------------------
    zIndex =  GetMaxZIndex() + 1;
    position = 'absolute';
  }
  //----------------------------------------------------------------------------
  WidgetMove(event,$WidgetID);
  //----------------------------------------------------------------------------
  SetAlpha($Widget,40);
}
//------------------------------------------------------------------------------
function WidgetRender($WidgetID){
  //----------------------------------------------------------------------------
  document.onmousedown = null;
  //----------------------------------------------------------------------------
  var $Widget = document.getElementById($WidgetID);
  //----------------------------------------------------------------------------
  SetAlpha($Widget,100);
  //----------------------------------------------------------------------------
  var $Inner = document.getElementById(SPrintF('%sInner',$WidgetID));
  //----------------------------------------------------------------------------
  WidgetSave($WidgetID);
}
//------------------------------------------------------------------------------
function WidgetSave($WidgetID){
  //----------------------------------------------------------------------------
  var $Widget = document.getElementById($WidgetID);
  //----------------------------------------------------------------------------
  var $IsStatic = ($Widget.style.position != 'absolute');
  //----------------------------------------------------------------------------
  var $Inner = document.getElementById(SPrintF('%sInner',$WidgetID));
  //----------------------------------------------------------------------------
  SetCookie($WidgetID,SPrintF('%u:%u:%u',$IsStatic?0:$Widget.offsetLeft,$IsStatic?0:$Widget.offsetTop,$Inner.style.display?'0':'1'));
}
//------------------------------------------------------------------------------
function WidgetSwitch($WidgetID){
  //----------------------------------------------------------------------------
  var $Widget = document.getElementById($WidgetID);
  //----------------------------------------------------------------------------
  with($Widget.style){
    //--------------------------------------------------------------------------
    zIndex =  GetMaxZIndex() + 1;
  }
  //----------------------------------------------------------------------------
  var $Inner = document.getElementById(SPrintF('%sInner',$WidgetID));
  //----------------------------------------------------------------------------
  $Inner.style.display = ($Inner.style.display?'':'none');
  //----------------------------------------------------------------------------
  WidgetSave($WidgetID);
}
//------------------------------------------------------------------------------
function WidgetMove(event,$WidgetID){
  //----------------------------------------------------------------------------
  var $Widget = document.getElementById($WidgetID);
  //----------------------------------------------------------------------------
  with($Widget.style){
    //--------------------------------------------------------------------------
    var $Body = document.body;
    //--------------------------------------------------------------------------
    var $clientX = Math.round(event.clientX/20)*20;
    var $clientY = Math.round(event.clientY/20)*20;
    //--------------------------------------------------------------------------
    var $OffsetX = $Body.clientWidth - ($clientX + $Widget.offsetWidth);
    var $OffsetY = $Body.clientHeight - ($OffsetY + $Widget.offsetHeight);
    //--------------------------------------------------------------------------
    left = $Body.scrollLeft + $clientX + ($OffsetX <0?$OffsetX:0);
    top  = $Body.scrollTop + $clientY + ($OffsetY <0?$OffsetY:0);
  }
}
//------------------------------------------------------------------------------
function WidgetDock($WidgetID){
  //----------------------------------------------------------------------------
  var $Widget = document.getElementById($WidgetID);
  //----------------------------------------------------------------------------
  with($Widget.style){
    //--------------------------------------------------------------------------
    position = 'static';
    display  = 'inline-table';
  }
  //----------------------------------------------------------------------------
  WidgetSave($WidgetID);
}
//------------------------------------------------------------------------------