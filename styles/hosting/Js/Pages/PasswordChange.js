//------------------------------------------------------------------------------
/** @author Alex Keda, for www.host-food.ru */
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
function PasswordMode($Code){
	//------------------------------------------------------------------------------
	//----------------------------------------------------------------------------
	//------------------------------------------------------------------------------
	var $Form = document.forms[$Code+'PasswordChangeForm'];
	//------------------------------------------------------------------------------
	//----------------------------------------------------------------------------
	with($Form){
		//------------------------------------------------------------------------------
		//--------------------------------------------------------------------------
		if(IsPasswordCreate.checked){
			//------------------------------------------------------------------------------
			//------------------------------------------------------------------------
			Password.value = IsPasswordCreate.value;
			//------------------------------------------------------------------------------
			Password.disabled = true;
			//------------------------------------------------------------------------------
		}else{
			//------------------------------------------------------------------------------
			//------------------------------------------------------------------------
			Password.value = '';
			//------------------------------------------------------------------------------
			Password.disabled = false;
			//------------------------------------------------------------------------------
		}
		//--------------------------------------------------------------------------
		//------------------------------------------------------------------------------
		_Password.value = Password.value;
		//------------------------------------------------------------------------------
		_Password.disabled = Password.disabled;
		//------------------------------------------------------------------------------
	}
	//------------------------------------------------------------------------------
}
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
function PasswordChange($Code){
	//----------------------------------------------------------------------------
	//------------------------------------------------------------------------------
	var $Form = document.forms[$Code+'PasswordChangeForm'];
	//----------------------------------------------------------------------------
	//------------------------------------------------------------------------------
	$HTTP = new HTTP();
	//----------------------------------------------------------------------------
	//------------------------------------------------------------------------------
	if(!$HTTP.Resource){
		//--------------------------------------------------------------------------
		//------------------------------------------------------------------------------
		alert('Не удалось создать HTTP соединение');
		//--------------------------------------------------------------------------
		//------------------------------------------------------------------------------
		return false;
		//------------------------------------------------------------------------------
	}
	//------------------------------------------------------------------------------
	//----------------------------------------------------------------------------
	$HTTP.onLoaded = function(){
		//--------------------------------------------------------------------------
		//------------------------------------------------------------------------------
		HideProgress();
		//------------------------------------------------------------------------------
	}
	//----------------------------------------------------------------------------
	//------------------------------------------------------------------------------
	$HTTP.onAnswer = function($Answer){
		//--------------------------------------------------------------------------
		//------------------------------------------------------------------------------
		switch($Answer.Status){
		case 'Error':
			//------------------------------------------------------------------------------
			ShowAlert($Answer.Error.String,'Warning');
			//------------------------------------------------------------------------------
			break;
			//------------------------------------------------------------------------------
		case 'Exception':
			//------------------------------------------------------------------------------
			ShowAlert(ExceptionsStack($Answer.Exception),'Warning');
			//------------------------------------------------------------------------------
			break;
			//------------------------------------------------------------------------------
		case 'Ok':
			//------------------------------------------------------------------------------
			ShowAlert('Пароль успешно изменен. На ваш электронный адрес отправлено уведомление.');
			//------------------------------------------------------------------------------
			break;
			//------------------------------------------------------------------------------
		default:
			alert('Не известный ответ');
		}
		//------------------------------------------------------------------------------
	}
	//------------------------------------------------------------------------------
	//----------------------------------------------------------------------------
	var $Args = FormGet($Form);
	//----------------------------------------------------------------------------
	//------------------------------------------------------------------------------
	if(!$HTTP.Send('/API/'+$Code+'PasswordChange',$Args)){
		//--------------------------------------------------------------------------
		//------------------------------------------------------------------------------
		alert('Не удалось отправить запрос на сервер');
		//--------------------------------------------------------------------------
		//------------------------------------------------------------------------------
		return false;
		//------------------------------------------------------------------------------
	}
	//------------------------------------------------------------------------------
	//----------------------------------------------------------------------------
	ShowProgress('Смена пароля');
	//------------------------------------------------------------------------------
}
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
